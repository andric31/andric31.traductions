<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jeu</title>

  <link rel="icon" href="/favicon.png" />
  <link rel="stylesheet" href="../viewer.css" />

  <link rel="stylesheet" href="./game.css" />
</head>

<body>
  <div class="wrap">
    <div class="cardPreview" id="card" aria-live="polite">
      <div class="cardInner">

        <div class="headRow">
          <button type="button" class="hamburger-btn" id="hamburgerBtn" aria-label="Ouvrir le menu" aria-haspopup="menu" aria-expanded="false">
            <span class="ham-lines" aria-hidden="true"><span></span><span></span><span></span></span>
          </button>

          <button class="btnLike like-btn" id="btnLike" type="button" aria-label="Jâ€™aime">ğŸ¤</button>

          <div class="badgesRow" id="badges"></div>
        </div>

        <div class="majState" id="majState" style="display:none;"></div>

        <h1 class="title" id="title">Chargementâ€¦</h1>

        <img id="cover" class="cover is-placeholder" alt="" referrerpolicy="no-referrer">

        <div id="videoBox" class="infoBlock" style="display:none;">
          <h3>ğŸ“º VidÃ©o</h3>
          <iframe id="videoFrame"
            style="width:100%; aspect-ratio:16/9; border-radius:12px; border:1px solid var(--border);"
            loading="lazy"
            allowfullscreen>
          </iframe>
        </div>

        <div id="mainInfoBox" class="infoBlock" style="display:none;">
          <div class="tagsRow" id="tags"></div>

          <div id="descInnerBox" class="descInnerBox" style="display:none;">
            <div id="descriptionText" class="infoText"></div>
          </div>
        </div>

        <!-- âœ… BOUTONS : juste AU-DESSUS des Ã©toiles -->
        <div class="btnRow">
          <a class="btnLike" id="btnDiscord" target="_blank" rel="noopener" style="display:none;">ğŸ’¬ Discord</a>
          <a class="btnLike" id="btnF95" target="_blank" rel="noopener" style="display:none;">F95Zone</a>
        </div>

        <div class="btnMainRow">
          <a class="btnLike btnMega" id="btnMega" target="_blank" rel="noopener" style="display:none;">ğŸ“¥ TÃ©lÃ©charger la traduction Â· MEGA</a>
          <!-- translationsExtra injectÃ© ici -->
        </div>

        <div id="archiveBox" style="display:none; margin-top:12px; justify-content:center;">
          <a id="archiveLink" class="btnLike" target="_blank" rel="noopener" style="justify-content:center;">
            ğŸ“¦ Archives de la traduction
          </a>
        </div>

        <!-- âœ… â„¹ï¸ Informations AU-DESSUS des Ã©toiles -->
        <div id="notesBox" class="infoBlock" style="display:none;">
          <h3>â„¹ï¸ Informations</h3>
          <div id="notesText" class="infoTextMuted"></div>
        </div>

        <!-- â­ Notation -->
        <div id="ratingBox" class="infoBlock" style="text-align:center;">
          <div style="color:var(--muted); font-size:12px; margin-bottom:6px;">
            Note de la traduction :
            <strong id="ratingAvg">â€”</strong>
            (<span id="ratingCount">0</span> votes)
          </div>

          <div id="ratingChoices" style="display:flex; justify-content:center; gap:8px;"></div>
          <div id="ratingMsg" style="margin-top:6px; color:var(--muted); font-size:12px;"></div>
        </div>

      </div>
    </div>

    <div class="statsOut" id="statsOut" style="display:none;">
      ğŸ‘ï¸ Vues : <strong id="statViews">0</strong>
      Â·
      â¤ï¸ Jâ€™aime : <strong id="statLikes">0</strong>
      Â·
      ğŸ“¥ TÃ©lÃ©chargements : <strong id="statMegaClicks">0</strong>
    </div>

    <div class="err" id="errBox"></div>
  </div>

  <script>
    (function(){
      const msg = document.getElementById("ratingMsg");
      if (!msg) return;

      const flash = () => {
        msg.classList.remove("msgFade");
        void msg.offsetWidth;
        msg.classList.add("msgFade");
      };

      const obs = new MutationObserver(() => flash());
      obs.observe(msg, { childList: true, characterData: true, subtree: true });

      if ((msg.textContent || "").trim()) flash();
    })();
  </script>

  <script src="../viewer.menu.js"></script>
  <script src="../viewer.menu.about.js"></script>
  <script src="../viewer.menu.extension.js"></script>
  <script src="./game.js"></script>

</body>
</html>
