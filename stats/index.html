<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stats â€” Traductions</title>

  <link rel="icon" href="/favicon.png" />
  <link rel="stylesheet" href="/stats/stats.css" />
</head>

<body class="stats-page">
  <div class="stats-wrap">
    <main class="stats-main">

      <section class="card">
        <div class="card-h tabs-h">
          <div class="tabs">
            <button class="tab-btn is-active" data-tab="overview" type="button">Overview</button>
            <button class="tab-btn" data-tab="trending" type="button">Trending</button>
            <button class="tab-btn" data-tab="timeline" type="button">Timeline</button>
            <button class="tab-btn" data-tab="ratings" type="button">Ratings</button>
          </div>
          <div class="tabs-actions">
            <button id="btnExportCsv" class="btn btn-ghost" type="button" title="Exporter en CSV">â¬‡ï¸ CSV</button>
          </div>
        </div>
      </section>

      <section class="tab-section" id="tab_overview">
        <section class="card">
          <div class="card-h">
            <div class="stats-title">
              <div class="h1">ğŸ“Š Stats</div>
              <div class="sub">https://andric31-traductions.pages.dev/</div>
            </div>

            <div class="stats-controls">
              <input id="q" class="inp" placeholder="Rechercher (titre, tags, idâ€¦)" autocomplete="off" />

              <select id="range" class="sel" title="PÃ©riode">
                <option value="total" selected>Total</option>
                <option value="24h">24h</option>
                <option value="7d">7j</option>
              </select>

              <select id="metric" class="sel" title="MÃ©trique du graphique">
                <option value="views">ğŸ‘ï¸ Vues</option>
                <option value="mega">ğŸ“¥ TÃ©lÃ©chargements</option>
                <option value="likes">â¤ï¸ Likes</option>
                <option value="ratingCount">â­ğŸ—³ï¸ Votes</option>
                <option value="ratingAvg">â­ Note (moy.)</option>
              </select>

              <select id="top" class="sel" title="Top">
                <option value="20" selected>Top 20</option>
                <option value="30">Top 30</option>
                <option value="40">Top 40</option>
                <option value="50">Top 50</option>
                <option value="100">Top 100</option>
                <option value="200">Top 200</option>
                <option value="300">Top 300</option>
                <option value="400">Top 400</option>
                <option value="500">Top 500</option>
                <option value="600">Top 600</option>
                <option value="700">Top 700</option>
                <option value="800">Top 800</option>
                <option value="900">Top 900</option>
                <option value="0">Tout</option>
              </select>
            </div>
          </div>

          <div class="site-kpis" id="siteKpis" aria-label="Stats du site">
            <div class="kpi"><span class="kpi-l">ğŸ‘ï¸ Vues page principale</span><span class="kpi-v" id="siteViews">â€”</span></div>
            <div class="kpi"><span class="kpi-l">â±ï¸ 24h</span><span class="kpi-v" id="siteViews24h">â€”</span></div>
            <div class="kpi"><span class="kpi-l">ğŸ“… 7j</span><span class="kpi-v" id="siteViews7d">â€”</span></div>

            <div class="kpi"><span class="kpi-l">ğŸ® Vues pages de jeu (total)</span><span class="kpi-v" id="gamesViews">â€”</span></div>
            <div class="kpi"><span class="kpi-l">â±ï¸ 24h</span><span class="kpi-v" id="gamesViews24h">â€”</span></div>
            <div class="kpi"><span class="kpi-l">ğŸ“… 7j</span><span class="kpi-v" id="gamesViews7d">â€”</span></div>

            <div class="kpi"><span class="kpi-l">ğŸ“¥ TÃ©lÃ©chargements (total jeux)</span><span class="kpi-v" id="gamesMega">â€”</span></div>
            <div class="kpi"><span class="kpi-l">â±ï¸ 24h</span><span class="kpi-v" id="gamesMega24h">â€”</span></div>
            <div class="kpi"><span class="kpi-l">ğŸ“… 7j</span><span class="kpi-v" id="gamesMega7d">â€”</span></div>

            <div class="kpi"><span class="kpi-l">â¤ï¸ Likes (total jeux)</span><span class="kpi-v" id="gamesLikes">â€”</span></div>
            <div class="kpi"><span class="kpi-l">â±ï¸ 24h</span><span class="kpi-v" id="gamesLikes24h">â€”</span></div>
            <div class="kpi"><span class="kpi-l">ğŸ“… 7j</span><span class="kpi-v" id="gamesLikes7d">â€”</span></div>
          
        <details class="help">
          <summary>â„¹ï¸ Ã€ quoi servent ces stats ?</summary>
          <div class="help-body">
            <p><b>ğŸ‘ï¸ Vues site</b> = compteur de la page principale (<code>/</code>) â€” utile pour mesurer lâ€™audience globale.</p>
            <p><b>ğŸ® Vues page de jeu</b>, <b>ğŸ“¥ TÃ©lÃ©chargements</b>, <b>â¤ï¸ Likes</b> = <u>somme de tous les jeux</u> (toutes les pages <code>/game/</code>). Les valeurs <b>24h</b> et <b>7j</b> viennent du journal dâ€™Ã©vÃ©nements cÃ´tÃ© API (pas juste le total).</p>
            <p><b>Top / Graphiques / Tableaux</b> : clique sur une ligne ou une barre pour ouvrir la page du jeu. Le champ â€œPÃ©riodeâ€ applique la fenÃªtre (<i>Total / 24h / 7j</i>) aux tris et aux classements.</p>
          </div>
        </details>
</div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">Graphique (Top)</div>
            <div class="card-actions">
              <div class="card-note" id="statusChart">Chargementâ€¦</div>
              <button id="btnChartExpand" class="btn-chart" type="button" title="Ã‰tendre le graphique">â¤¢</button>
            </div>
          </div>
          <div class="chart-wrap">
            <canvas id="chart" width="1400" height="560"></canvas>
          </div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">Tableau</div>
            <div class="card-note" id="statusTable">â€”</div>
          </div>

          <div class="table-wrap">
            <table class="tbl" id="tbl">
              <thead>
                <tr>
                  <th class="c-cover">Cover</th>
                  <th data-sort="title">Titre</th>
                  <th class="num" data-sort="views">ğŸ‘ï¸</th>
                  <th class="num" data-sort="mega">ğŸ“¥</th>
                  <th class="num" data-sort="likes">â¤ï¸</th>
                  <th class="num" data-sort="ratingCount">â­ğŸ—³ï¸</th>
                  <th class="num" data-sort="ratingAvg">â­</th>
                </tr>
              </thead>
              <tbody id="tbody"></tbody>
            </table>
          </div>
        </section>
      </section>

      <section class="tab-section" id="tab_trending" style="display:none;">
        <section class="card">
          <div class="card-h">
            <div class="card-title">ğŸ”¥ Trending</div>
            <div class="stats-controls">
              <select id="trendWindow" class="sel" title="FenÃªtre">
                <option value="24h" selected>24h</option>
                <option value="7d">7j</option>
              </select>

              <select id="trendMetric" class="sel" title="MÃ©trique">
                <option value="views" selected>ğŸ‘ï¸ Vues</option>
                <option value="mega">ğŸ“¥ TÃ©lÃ©chargements</option>
                <option value="likes">â¤ï¸ Likes</option>
                <option value="score">ğŸ”¥ Score trending</option>
              </select>

              <select id="trendEngine" class="sel" title="Moteur">
                <option value="" selected>ğŸ® Tous moteurs</option>
              </select>

              <select id="trendStatus" class="sel" title="Statut">
                <option value="" selected>ğŸ“Œ Tous statuts</option>
              </select>

              <input id="trendTag" class="inp" placeholder="Filtre tag (ex: renpy, incestâ€¦)" autocomplete="off" />
            </div>
          </div>

          <div class="mini-kpis">
            <div class="kpi"><span class="kpi-l">Total fenÃªtre</span><span class="kpi-v" id="trendTotal">â€”</span></div>
            <div class="kpi"><span class="kpi-l">Jeux visibles</span><span class="kpi-v" id="trendCount">â€”</span></div>

          <div class="chip-groups">
            <div class="chip-group">
              <div class="chip-title">ğŸ® Moteurs qui montent</div>
              <div class="chips" id="trendEngChips"></div>
            </div>
            <div class="chip-group">
              <div class="chip-title">ğŸ“Œ Statuts</div>
              <div class="chips" id="trendStatusChips"></div>
            </div>
            <div class="chip-group">
              <div class="chip-title">ğŸ·ï¸ Tags (clique pour filtrer)</div>
              <div class="chips" id="trendTagChips"></div>
            </div>
          </div>

          <details class="help">
            <summary>â„¹ï¸ Comment lire â€œTrendingâ€ ?</summary>
            <div class="help-body">
              <p>Ce bloc sert Ã  voir <b>ce qui bouge</b> sur une fenÃªtre courte (<b>24h</b> ou <b>7j</b>).</p>
              <p><b>ğŸ”¥ Score trending</b> = <code>vues + 3Ã—tÃ©lÃ©chargements + 2Ã—likes</code> (sur la fenÃªtre). Câ€™est pratique pour dÃ©tecter un jeu â€œchaudâ€ mÃªme si ses vues seules ne sont pas Ã©normes.</p>
              <p>Les â€œchipsâ€ te proposent des filtres rapides (moteur / statut / tag) basÃ©s sur la fenÃªtre choisie.</p>
            </div>
          </details>
          </div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">Graphique (Trending)</div>
            <div class="card-note" id="trendStatusLine">â€”</div>
          </div>
          <div class="chart-wrap">
            <canvas id="trendChart" width="1400" height="560"></canvas>
          </div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">Tableau (Trending)</div>
            <div class="card-note" id="trendTableStatus">â€”</div>
          </div>
          <div class="table-wrap">
            <table class="tbl" id="trendTbl">
              <thead>
                <tr>
                  <th class="c-cover">Cover</th>
                  <th>Titre</th>
                  <th class="num">Score</th>
                  <th class="num">FenÃªtre</th>
                  <th class="num">Total</th>
                </tr>
              </thead>
              <tbody id="trendTbody"></tbody>
            </table>
          </div>
        </section>
      </section>

      <section class="tab-section" id="tab_timeline" style="display:none;">
        <section class="card">
          <div class="card-h">
            <div class="card-title">ğŸ•’ Timeline (rapide)</div>
            <div class="card-note">Pas une vraie courbe/jour (pas d'historique D1), mais un rÃ©sumÃ© â€œactivitÃ© rÃ©centeâ€.</div>
          </div>

          <div class="site-kpis">
            <div class="kpi"><span class="kpi-l">ğŸ‘ï¸ Vues jeux Â· 24h</span><span class="kpi-v" id="tlViews24h">â€”</span></div>
            <div class="kpi"><span class="kpi-l">ğŸ“¥ TÃ©lÃ©ch. jeux Â· 24h</span><span class="kpi-v" id="tlMega24h">â€”</span></div>
            <div class="kpi"><span class="kpi-l">â¤ï¸ Likes jeux Â· 24h</span><span class="kpi-v" id="tlLikes24h">â€”</span></div>

            <div class="kpi"><span class="kpi-l">ğŸ‘ï¸ Vues jeux Â· 7j</span><span class="kpi-v" id="tlViews7d">â€”</span></div>
            <div class="kpi"><span class="kpi-l">ğŸ“¥ TÃ©lÃ©ch. jeux Â· 7j</span><span class="kpi-v" id="tlMega7d">â€”</span></div>
            <div class="kpi"><span class="kpi-l">â¤ï¸ Likes jeux Â· 7j</span><span class="kpi-v" id="tlLikes7d">â€”</span></div>
          </div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">ğŸš€ Top movers (24h)</div>
            <div class="card-note" id="tlMoversStatus">â€”</div>
          </div>
          <div class="table-wrap">
            <table class="tbl">
              <thead>
                <tr>
                  <th class="c-cover">Cover</th>
                  <th>Titre</th>
                  <th class="num">ğŸ‘ï¸ 24h</th>
                  <th class="num">ğŸ“¥ 24h</th>
                  <th class="num">â¤ï¸ 24h</th>
                </tr>
              </thead>
              <tbody id="tlTbody"></tbody>
            </table>
          </div>
        </section>
      </section>

      <section class="tab-section" id="tab_ratings" style="display:none;">
        <section class="card">
          <div class="card-h">
            <div class="card-title">â­ Ratings</div>
            <div class="stats-controls">
              <select id="bayesM" class="sel" title="Force du prior (m)">
                <option value="5">m=5 (rapide)</option>
                <option value="10" selected>m=10 (Ã©quilibrÃ©)</option>
                <option value="20">m=20 (strict)</option>
                <option value="50">m=50 (IMDB-like)</option>
              </select>
              <select id="ratingsTop" class="sel" title="Top">
                <option value="20" selected>Top 20</option>
                <option value="50">Top 50</option>
                <option value="100">Top 100</option>
                <option value="0">Tout</option>
              </select>
            </div>
          </div>

          <div class="mini-kpis">
            <div class="kpi"><span class="kpi-l">Moyenne globale (C)</span><span class="kpi-v" id="bayesC">â€”</span></div>
            <div class="kpi"><span class="kpi-l">Jeux notÃ©s</span><span class="kpi-v" id="ratedCount">â€”</span></div>
          </div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">Graphique (Bayesian)</div>
            <div class="card-note" id="ratingsStatusLine">â€”</div>
          </div>
          <div class="chart-wrap">
            <canvas id="ratingsChart" width="1400" height="560"></canvas>
          </div>
        </section>

        <section class="card">
          <div class="card-h">
            <div class="card-title">Classement Bayesian</div>
            <div class="card-note" id="ratingsTableStatus">â€”</div>
          </div>
          <div class="table-wrap">
            <table class="tbl" id="ratingsTbl">
              <thead>
                <tr>
                  <th class="c-cover">Cover</th>
                  <th>Titre</th>
                  <th class="num">Bayes</th>
                  <th class="num">â­ Moy.</th>
                  <th class="num">ğŸ—³ï¸ Votes</th>
                </tr>
              </thead>
              <tbody id="ratingsTbody"></tbody>
            </table>
          </div>
        </section>
      </section>

    </main>
  </div>

  <script src="/stats/stats.js"></script>
</body>
</html>
